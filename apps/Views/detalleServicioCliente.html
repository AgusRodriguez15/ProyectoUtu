<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Detalle del Servicio</title>
  <link rel="stylesheet" href="../../public/CSS/styleStart.css">
  <link rel="stylesheet" href="../../public/CSS/styleDetalle.css">
</head>
<body>
  <header class="header">
    <div class="logo"><h1>Plataforma de Oficios</h1></div>
    <nav class="nav">
      <a href="PANTALLA_CONTRATAR.html">Servicios</a>
      <a href="misContrataciones.html">Mis Contrataciones</a>
      <a href="perfilUsuario.html">Mi Perfil</a>
      <a href="#">Mensajes</a>
    </nav>
  </header>

  <div class="detalle-container">
    <button class="btn-volver" onclick="history.back()">← Volver</button>
    
    <div id="contenidoDetalle">
      <p class="cargando">Cargando detalles del servicio...</p>
    </div>
  </div>

  <!-- Templates HTML -->
  <template id="template-servicio-detalle">
    <div class="servicio-detalle">
      <div class="servicio-imagen">
        <img class="imagen-principal" alt="">
        <div class="galeria-fotos"></div>
      </div>
      
      <div class="servicio-info">
        <h1 class="servicio-nombre"></h1>
        
        <div class="servicio-meta">
          <span class="badge estado"></span>
          <span class="fecha-publicacion"></span>
        </div>
        
        <div class="servicio-precio">
          <h3>💰 Precio</h3>
          <div class="precio-display"></div>
        </div>
        
        <div class="servicio-descripcion-container">
          <div class="tabs-container">
            <div class="tabs">
              <button class="tab-btn active" data-tab="descripcion">📝 Descripción</button>
              <button class="tab-btn" data-tab="comentarios">💬 Comentarios</button>
            </div>
            
            <div class="tab-content active" id="tab-descripcion">
              <p class="servicio-descripcion"></p>
            </div>
            
            <div class="tab-content" id="tab-comentarios">
              <div class="comentarios-section">
                <h3>Reseñas y Comentarios</h3>
                
                <div class="agregar-comentario formulario-comentario">
                  <h4>Deja tu opinión</h4>
                  <div class="rating-input">
                    <label>Calificación:</label>
                    <div class="stars">
                      <span class="star" data-rating="1">★</span>
                      <span class="star" data-rating="2">★</span>
                      <span class="star" data-rating="3">★</span>
                      <span class="star" data-rating="4">★</span>
                      <span class="star" data-rating="5">★</span>
                    </div>
                  </div>
                  <textarea id="comentarioTexto" placeholder="Escribe tu comentario aquí..." rows="4"></textarea>
                  <button class="btn-primary btn-enviar-comentario">Publicar Comentario</button>
                </div>
                
                <div class="lista-comentarios" id="listaComentarios">
                  <p class="cargando-comentarios">Cargando comentarios...</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="servicio-ubicaciones">
          <h3>📍 Ubicaciones del Servicio</h3>
          <div class="ubicaciones-carrusel">
            <div class="ubicaciones-lista"></div>
          </div>
          <div class="carrusel-controles">
            <button class="carrusel-btn btn-anterior" aria-label="Ubicación anterior">◀</button>
            <div class="carrusel-indicadores"></div>
            <span class="carrusel-contador"></span>
            <button class="carrusel-btn btn-siguiente" aria-label="Ubicación siguiente">▶</button>
          </div>
        </div>
        
        <div class="servicio-disponibilidades">
          <h3>📅 Disponibilidad del Servicio</h3>
          <div class="disponibilidades-lista">
            <p class="cargando">Cargando disponibilidades...</p>
          </div>
        </div>
        
        <div class="servicio-proveedor">
          <h3>👤 Proveedor</h3>
          <div class="proveedor-card">
            <div class="proveedor-foto" style="display: none;">
              <img class="proveedor-imagen" alt="Foto del proveedor">
            </div>
            
            <div class="proveedor-info">
              <p class="proveedor-nombre"></p>
              <p class="proveedor-descripcion" style="display: none;"></p>
              
              <div class="proveedor-contactos" style="display: none;">
                <h4>📞 Datos de Contacto:</h4>
                <ul class="contactos-lista"></ul>
              </div>
              
              <div class="proveedor-habilidades" style="display: none;">
                <h4>💼 Habilidades:</h4>
                <div class="habilidades-tags"></div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="servicio-acciones">
          <button class="btn-primary btn-contratar">🛒 Contratar Servicio</button>
          <button class="btn-secondary btn-mensaje" id="btnAbrirModalMensaje">💬 Enviar Mensaje</button>
          <button class="btn-terciary btn-perfil">👤 Ver Perfil</button>
        </div>
      </div>
    </div>
  </template>

  <template id="template-foto-miniatura">
    <img class="foto-miniatura" alt="Foto del servicio">
  </template>

  <template id="template-contacto-item">
    <li><strong class="contacto-tipo"></strong> <span class="contacto-valor"></span></li>
  </template>

  <template id="template-habilidad-tag">
    <span class="habilidad-tag"></span>
  </template>

  <template id="template-ubicacion-item">
    <div class="ubicacion-item">
      <div class="ubicacion-icono">📍</div>
      <div class="ubicacion-detalle">
        <p class="ubicacion-direccion"></p>
        <p class="ubicacion-ciudad"></p>
      </div>
    </div>
  </template>

  <template id="template-sin-comentarios">
    <p class="sin-comentarios">Aún no hay comentarios. ¡Sé el primero en dejar uno!</p>
  </template>

  <template id="template-error-comentarios">
    <p class="sin-comentarios">Error al cargar los comentarios</p>
  </template>

  <template id="template-ya-reseno">
    <div class="mensaje-ya-reseno">
      <p>
        <strong>Ya has dejado una reseña para este servicio.</strong><br>
        Solo se permite una reseña por usuario.
      </p>
    </div>
  </template>

  <template id="template-comentario-item">
    <div class="comentario-item">
      <div class="comentario-header">
        <div class="usuario-info">
          <img class="usuario-foto" alt="" src="">
          <strong class="usuario-nombre"></strong>
        </div>
        <div class="comentario-rating"></div>
      </div>
      <p class="comentario-texto"></p>
      <span class="comentario-fecha"></span>
    </div>
  </template>

  <template id="template-disponibilidad-item">
    <div class="disponibilidad-item">
      <div class="disponibilidad-info">
        <span class="disponibilidad-fechas"></span>
        <span class="badge-estado"></span>
      </div>
    </div>
  </template>

  <!-- Modal de Reserva -->
  <div id="modalReserva" class="modal" style="display: none;">
    <div class="modal-contenido">
      <span class="modal-cerrar">&times;</span>
      <h2>🛒 Contratar Servicio</h2>
      
      <form id="formReserva">
        <div class="disponibilidades-disponibles">
          <h4>Seleccione un horario disponible:</h4>
          <div class="lista-horarios-disponibles"></div>
        </div>
        
        <div class="horario-seleccionado-info" style="display: none;">
          <div class="info-box">
            <h4>📅 Horario seleccionado:</h4>
            <p id="textoHorarioSeleccionado" class="horario-texto"></p>
          </div>
        </div>
        
        <input type="hidden" id="fechaInicioReserva" name="fechaInicio">
        <input type="hidden" id="fechaFinReserva" name="fechaFin">
        
        <div class="form-group">
          <label for="observacionReserva">📝 Observaciones (opcional):</label>
          <textarea id="observacionReserva" name="observacion" rows="4" placeholder="Detalles adicionales sobre el servicio que necesitas..."></textarea>
        </div>
        
        <div class="modal-acciones">
          <button type="submit" class="btn-primary">Confirmar Reserva</button>
          <button type="button" class="btn-secondary btn-cancelar-reserva">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal de Mensaje (simple) -->
  <div id="modalMensaje" class="modal" style="display: none;">
    <div class="modal-contenido">
      <span class="modal-cerrar" id="modalMensajeCerrar">&times;</span>
      <h2>💬 Enviar mensaje</h2>
      <p id="modalMensajeProveedorNombre" style="font-weight:600;margin-bottom:8px"></p>
      <textarea id="mensajeModalTexto" rows="4" placeholder="Escribe tu mensaje..." style="width:100%;padding:8px;border:1px solid #ccc;border-radius:4px"></textarea>
      <div style="margin-top:8px;display:flex;gap:8px;justify-content:flex-end">
        <button id="btnCancelarMensajeModal" class="btn-secondary">Cancelar</button>
        <button id="btnEnviarMensajeModal" class="btn-primary">Enviar</button>
      </div>
      <div id="modalMensajeFeedback" style="display:none;margin-top:8px;color:green"></div>
    </div>
  </div>

  <script src="../../public/js/detalleServicioCliente.js"></script>
</body>
</html>
